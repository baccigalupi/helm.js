{"version":3,"sources":["helm-0.7.0.min.js"],"names":["factory","root","self","global","exports","_","$","Backbone","require","e","jQuery","Zepto","ender","Helm","Mixins","Overrides","RequestMiddleware","Subscribers","BaseClass","this","initialize","apply","arguments","prototype","_init","init","extend","Model","AuthToken","args","type","toLowerCase","data","clone","perform","isDataRequest","handlePostPutPatch","isDeleteRequest","handleDelete","url","encodeURIComponent","authenticityToken","isString","repackageStringData","addAuthToken","JSON","parse","authenticity_token","constructor","token","stringify","ServerNotifications","complete","wrapComplete","callback","xhr","status","response","responseText","publisher","Notifications","each","events","value","key","publish","ajax","map","a","ClickEvent","isTouch","window","DocumentTouch","document","isWindows","test","navigator","userAgent","shouldOverride","normalizeListeners","listeners","newKey","replace","Function","bind","context","func","DotPath","find","object","path","i","paths","split","length","current","isObject","undefined","Subviews","renderEach","subviews","_subviews","view","parent","defaultParent","repository","templates","viewModelClasses","router","render","remove","removeSelf","afterRender","TextUtils","camelize","word","g","toUpperCase","littelCamelize","underscore","shorten","text","n","substr","stripTags","Redirector","location","View","opts","config","defaultConfig","result","attach","viewModel","_events","renderSelf","renderSubviews","attachToParent","template","rendered","$el","html","$parent","ParentFinder","parentSelector","el","viewModelClass","isfunction","ViewModel","subject","model","collection","toJSON","partials","selector","found","findIn$","searchParent","seekGlobally","element","is","App","attr","start","setup","manageHistory","history","History","routerClass","Router","Error","createRepository","Klass","Repository","loadTemplates","RawTemplates","loadRawTemplates","Templates","rawTemplates","Hogan","compile","injectRouter","app","ViewModels","klass","Models","Views","presented","presentedToJSON","json","inclusions","include","prop","base","CollectionViewModel","presentedCollection","inclusionsForModel","models","merged","baseJSON","rootKey","list","started","listenTo","on","push","fragment","pop","Events","event","trigger","subscribe","unsubscribe","off","route","name","isRegExp","_routeToRegExp","_extractParameters","execute","concat","go","navigate","back","page","empty"],"mappings":"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","file":"helm-0.7.0.min.js","sourcesContent":["(function(factory) {\n  // this load pattern is taken from Backbone, removes AMD support for right now\n\n  // Establish the root object, `window` (`self`) in the browser, or `global` on the server.\n  // We use `self` instead of `window` for `WebWorker` support.\n  var root = (typeof self == 'object' && self.self == self && self) ||\n    (typeof global == 'object' && global.global == global && global)\n\n  if (typeof exports !== 'undefined') {\n    // for node on the server\n    var _, $;\n    var Backbone = require('backbone');\n    try {\n      $ = require('jquery');\n    } catch (e) {}\n    try {\n      _ = require('underscore');\n    } catch (e) {}\n\n    factory(root, exports, _, $, Backbone);\n  } else {\n    // for the browser\n    root.Backbone = factory(root, {}, root._, (root.jQuery || root.Zepto || root.ender || root.$), root.Backbone);\n  }\n\n}(function(root, Helm, _, $, Backbone) {\n  Helm.Mixins = {}\n  Helm.Overrides = {}\n  Helm.RequestMiddleware = {}\n  Helm.Subscribers = {}\n\n  Helm.BaseClass = function() {\n    this.initialize.apply(this, arguments)\n  }\n\n  Helm.BaseClass.prototype.initialize = function() {\n    this._init.apply(this, arguments)\n    this.init.apply(this, arguments)\n  }\n\n  Helm.BaseClass.prototype.init = Helm.BaseClass.prototype._init = function() {}\n\n  Helm.BaseClass.extend = Backbone.Model.extend\n\n  Helm.RequestMiddleware.AuthToken = Helm.BaseClass.extend({\n    initialize: function(args) {\n      this.args = args\n      this.type = args.type.toLowerCase()\n      this.data = _.clone(args.data || {})\n    },\n\n    perform: function() {\n      if (this.isDataRequest()) {\n        this.handlePostPutPatch()\n      } else if (this.isDeleteRequest()) {\n        this.handleDelete()\n      }\n      return this.args\n    },\n\n    isDataRequest: function() {\n      return this.type === 'post' || this.type === 'put' || this.type === 'patch'\n    },\n\n    isDeleteRequest: function() {\n      return this.type === 'delete'\n    },\n\n    handleDelete: function() {\n      this.args.url = this.args.url +\n        '?authenticity_token=' +\n        encodeURIComponent(this.authenticityToken)\n    },\n\n    handlePostPutPatch: function() {\n      if (_.isString(this.data)) {\n        this.repackageStringData()\n      }\n\n      this.addAuthToken()\n    },\n\n    repackageStringData: function() {\n      this.data = JSON.parse(this.data)\n    },\n\n    addAuthToken: function() {\n      var data = _.extend(this.data, {\n        authenticity_token: this.constructor.token\n      })\n      this.args.data = this.data = JSON.stringify(data)\n    }\n  })\n\n  Helm.RequestMiddleware.ServerNotifications = Helm.BaseClass.extend({\n    initialize: function(args) {\n      this.args = args\n    },\n\n    perform: function() {\n      this.args.complete = this.wrapComplete(this.args.complete)\n      return this.args\n    },\n\n    wrapComplete: function(callback) {\n      return function(xhr, status) {\n        // call the original callback\n        if (callback) {\n          callback(xhr, status)\n        }\n\n        // extract the JSON data\n\n        var response = xhr.response || xhr.responseText || '{}'\n        var data = JSON.parse(response)\n        var publisher = Helm.Notifications\n\n        // publish each event received\n        _.each(data.events || {}, function(value, key) {\n          publisher.publish(key, value)\n        })\n      }\n    }\n  })\n\n  Backbone.ajax = function() {\n    var args = _.map(arguments, function(a) {\n      return (new Helm.RequestMiddleware.AuthToken(a)).perform()\n    })\n    args = _.map(args, function(a) {\n      return (new Helm.RequestMiddleware.ServerNotifications(a)).perform()\n    })\n\n    return Backbone.$.ajax.apply(Backbone.$, args)\n  }\n\n  /*\n   * Touch devices often wait 250ms to convert touchstart/touchstop pairs into a click.\n   * This leads to terrible feeling mobile first applications.\n   * Add this in if you want to get snappier clicks.\n   */\n  Helm.Overrides.ClickEvent = {\n    isTouch: function() {\n      // taken from Modernizr: http://modernizr.com/license\n      return (('ontouchstart' in window) || window.DocumentTouch && document instanceof window.DocumentTouch)\n    },\n\n    // windows touch + mouse devices create a total crap show show\n    isWindows: function() {\n      /Windows/i.test(navigator.userAgent)\n    },\n\n    shouldOverride: function() {\n      return !this.isWindows() && this.isTouch()\n    },\n\n    normalizeListeners: function(listeners) {\n      if (!this.shouldOverride()) {\n        return listeners\n      }\n\n      var events = {}\n      var newKey\n      _.each(listeners, function(value, key) {\n        newKey = key.replace('click', 'touchstart')\n        events[newKey] = value\n      })\n\n      return events\n    }\n  }\n\n  if (!Function.prototype.bind) {\n    Function.prototype.bind || function(context) {\n      var func = this\n      return function() {\n        return func.apply(context, arguments)\n      }\n    }\n  }\n\n\n  Helm.Mixins.DotPath = {\n    find: function(object, path) {\n      var paths = path.split('.')\n      var length = paths.length\n      var current = object\n      var i\n      for (i = 0; i < length; i++) {\n        if (_.isObject(current)) {\n          current = current[paths[i]]\n        } else {\n          current = undefined\n          break\n        }\n      }\n      return current\n    }\n  }\n\n  Helm.Mixins.Subviews = {\n    renderEach: function(subviews) {\n      this._subviews = subviews\n\n      _.each(subviews, function(view) {\n        if (view) {\n          view.parent = view.parent || this.defaultParent()\n          view.repository = view.repository || this.repository\n          view.templates = view.templates || this.templates\n          view.viewModelClasses = view.viewModelClasses || this.viewModelClasses\n          view.router = view.router || this.router\n          view.render()\n        }\n      }.bind(this))\n    },\n\n    remove: function() {\n      this.removeSelf()\n\n      _.each(this._subviews || [], function(view) {\n        view.remove()\n      })\n    },\n\n    removeSelf: function() {\n      // override me!\n    },\n\n    defaultParent: function() {\n      return this\n    },\n\n    subviews: function() {\n      return []\n    },\n    afterRender: function() {}\n  }\n\n  Helm.Mixins.TextUtils = {\n    camelize: function(word) {\n      return word\n        .replace(/^(\\w)/, function(g) {\n          return g.toUpperCase()\n        }).replace(/(_\\w)/g, function(g) {\n          return g[1].toUpperCase()\n        })\n    },\n\n    littelCamelize: function(word) {\n      return word.replace(/(_\\w)/g, function(g) {\n        return g[1].toUpperCase()\n      })\n    },\n\n    underscore: function(word) {\n      return word\n        .replace(/^(\\w)/, function(g) {\n          return g.toLowerCase()\n        })\n        .replace(/([A-Z])/g, function(g) {\n          return '_' + g.toLowerCase()\n        })\n    },\n\n    shorten: function(text, n) {\n      if (!text || !n) {\n        return\n      }\n\n      if (text.length > n) {\n        text = text.substr(0, n) + '...'\n      }\n      return text\n    },\n\n    stripTags: function(text) {\n      return text\n        .replace(/<(?:.|\\n)*?>/gm, ' ')\n        .replace(/\\s+/g, ' ')\n        .replace(/^\\s/, '')\n    }\n  }\n\n\n  Helm.Subscribers.Redirector = function(url) {\n    window.location = url\n  }\n\n  Helm.View = Backbone.View.extend(Helm.Mixins.Subviews).extend({\n    initialize: function(opts) {\n      this._init(opts)\n      this.init(opts)\n    },\n\n    _init: function(opts) {\n      opts || (opts = {})\n      this.config = _.extend(_.clone(this.defaultConfig), this.config)\n      this.parent = opts.parent || _.result(this, 'parent')\n    },\n\n    defaultConfig: {\n      attach: 'append',\n      viewModel: 'ViewModel'\n    },\n\n    events: function() {\n      if (this._events) {\n        return this._events\n      }\n      this._events = Helm.Overrides.ClickEvent.normalizeListeners(_.result(this.config, 'events') || {})\n      return this._events\n    },\n\n    render: function() {\n      this.renderSelf()\n      this.renderSubviews()\n      this.attachToParent()\n      this.afterRender()\n    },\n\n    renderSelf: function() {\n      var template = this.template()\n      if (!template) {\n        return\n      }\n\n      var rendered = template.render(this.viewModel(), _.result(this, 'partials'))\n      this.$el.html(rendered)\n    },\n\n    renderSubviews: function() {\n      this.renderEach(this.subviews())\n    },\n\n    attachToParent: function() {\n      var $parent = new Helm.View.ParentFinder(\n        this.parent, this.config.parentSelector\n      ).perform()\n\n      $parent && $parent[this.config.attach](this.el)\n    },\n\n    removeSelf: function() {\n      Backbone.View.prototype.remove.apply(this)\n    },\n\n    viewModelClass: function() {\n      if (_.isfunction(this.config.viewModel)) {\n        return this.config.viewModel()\n      } else {\n        return Helm.Mixins.DotPath.find(this.viewModelClasses, this.config.viewModel) || Helm.ViewModel\n      }\n    },\n\n    template: function() {\n      if (!this.config.template) {\n        return\n      }\n      return this.templates[_.result(this.config, 'template')]\n    },\n\n    viewModel: function() {\n      var subject = this.model || this.collection\n      var viewModel = new(this.viewModelClass())(subject)\n      viewModel.repository || (viewModel.repository = this.repository)\n      return viewModel.toJSON()\n    },\n\n    // ----------- Functions and Attrs to override\n\n    init: function() {},\n    subviews: function() {\n      return []\n    },\n    config: {},\n    partials: function() {\n      return this.templates\n    }\n  })\n\n  Helm.View.ParentFinder = Helm.BaseClass.extend({\n    initialize: function(parent, selector) {\n      this.parent = parent\n      this.selector = selector\n    },\n\n    perform: function() {\n      if (!this.parent && !this.selector) {\n        return\n      }\n\n      var found\n      if (!this.parent) {\n        found = this.seekGlobally()\n      } else if (!this.selector) {\n        found = this.searchParent()\n      } else {\n        found = this.findIn$(this.searchParent())\n      }\n      return found\n    },\n\n    searchParent: function() {\n      return this.parent.$el ? this.parent.$el : this.parent\n    },\n\n    seekGlobally: function() {\n      var element = $(this.selector)\n      if (element.length) {\n        return element\n      }\n    },\n\n    findIn$: function(parent) {\n      if (!this.selector) {\n        return parent\n      }\n\n      var element = parent.find(this.selector)\n      if (!element.length && parent.is(this.selector)) {\n        element = parent\n      }\n\n      if (element.length) {\n        return element\n      }\n    }\n  })\n\n  Helm.App = Helm.BaseClass.extend(Helm.Mixins.Subviews).extend({\n    _init: function($el) {\n      this.$el = this.parent = $el\n      Helm.RequestMiddleware.AuthToken.token = $('meta[name=\"csrf-token\"]').attr('content')\n    },\n\n    start: function() {\n      this.setup()\n      this.render()\n    },\n\n    render: function() {\n      this.renderEach(this.subviews())\n      this.afterRender()\n    },\n\n    manageHistory: function() {\n      if (Helm.history) {\n        this.history = Helm.history\n      } else {\n        this.history = Helm.history = new Helm.History()\n      }\n    },\n\n    routerClass: function() {\n      if (this.constructor.Router) {\n        return this.constructor.Router\n      }\n      throw new Error('No Router class found!')\n    },\n\n    createRepository: function() {\n      var Klass = this.constructor.Repository\n      Klass || (Klass = this.Repository)\n      if (Klass) {\n        return new Klass()\n      } else {\n        return {}\n      }\n    },\n\n    loadTemplates: function() {\n      if (this.constructor.RawTemplates) {\n        this.loadRawTemplates()\n      }\n    },\n\n    loadRawTemplates: function() {\n      var templates = this.constructor.Templates\n      var rawTemplates = this.constructor.RawTemplates\n      _.each(rawTemplates, function(value, key) {\n        templates[key] = Hogan.compile(value)\n      })\n    },\n\n    setup: function() {\n      this.loadTemplates()\n      this.manageHistory()\n      this.repository || (this.repository = this.createRepository())\n      this.router = new(this.routerClass())(this, this.$el)\n      this.injectRouter()\n      this.history.start()\n    },\n\n    injectRouter: function() {\n      var router = this.router\n      router.app = this\n      router.repository = this.repository\n      router.templates = this.constructor.Templates\n      router.viewModelClasses = this.constructor.ViewModels\n      router.router = router\n    }\n  })\n\n  Helm.App.extend = function() {\n    var klass = Helm.BaseClass.extend.apply(this, arguments)\n    klass.Models = {}\n    klass.Views = {}\n    klass.Templates = {}\n    klass.ViewModels = {}\n    return klass\n  }\n\n  Helm.ViewModel = Helm.BaseClass.extend({\n    _init: function(presented) {\n      this.presented = presented || {}\n    },\n\n    presentedToJSON: function() {\n      var json\n      if (this.presented && this.presented.toJSON) {\n        json = this.presented.toJSON()\n      }\n      return json || this.presented\n    },\n\n    inclusions: function() {\n      var inclusions = {}\n      _.each(this.include || [], function(prop) {\n        inclusions[prop] = _.result(this, prop) || _.result(this, Helm.Mixins.TextUtils.littelCamelize(prop))\n      }.bind(this))\n      return inclusions\n    },\n\n    /*\n      Returns a template-friendly json representation of `presented`.\n  \n      Example:\n  \n        var model = new Backbone.Model({ username: \"socialcoder\" })\n  \n        var MyViewModel = NailPolish.ViewModel.extend({\n          include: [\"status\", \"likes\"],\n  \n          status: \"better than ever\",\n  \n          likes: function () {\n            return [\"clean code\", \"nice documentation\"]\n          }\n        })\n  \n        var viewModel = new MyViewModel(model)\n  \n        viewModel.toJSON()\n  \n        // {\n        //   \"likes\": [\"clean code\", \"nice documentation\"],\n        //   \"status\": \"better than ever\",\n        //   \"username\": \"socialcoder\",\n        //   \"username_error\": \"is too awesome\"\n        // }\n    */\n    toJSON: function() {\n      var base = this.presentedToJSON()\n      var inclusions = this.inclusions()\n      return _.extend(base, inclusions)\n    }\n  })\n\n\n  Helm.CollectionViewModel = Helm.BaseClass.extend({\n    _init: function(presented) {\n      this.presentedCollection = presented || []\n    },\n\n    presentedToJSON: function() {\n      var json\n      if (this.presentedCollection && this.presentedCollection.toJSON) {\n        json = this.presentedCollection.toJSON()\n      }\n      return json || this.presentedCollection\n    },\n\n    inclusionsForModel: function(model) {\n      this.presented = model\n      var inclusions = {}\n\n      _.each(this.include || [], function(prop) {\n        inclusions[prop] = _.result(this, prop) || _.result(this, Helm.Mixins.TextUtils.littelCamelize(prop))\n      }.bind(this))\n\n      return inclusions\n    },\n\n    inclusions: function() {\n      var models = this.presentedCollection.models || this.presentedCollection\n\n      return _.map(models, function(model) {\n        return this.inclusionsForModel(model)\n      }.bind(this))\n    },\n\n    toJSON: function() {\n      var base = this.presentedToJSON()\n      var inclusions = this.inclusions()\n\n      var merged = _.map(base, function(baseJSON, i) {\n        return _.extend(baseJSON, inclusions[i] || {})\n      })\n\n      var json = merged\n      if (this.rootKey !== false) {\n        json = {}\n        var rootKey = this.rootKey || 'collection'\n        json[rootKey] = merged\n      }\n      return json\n    }\n  })\n\n\n  Helm.History = Helm.BaseClass.extend({\n    initialize: function() {\n      this.list = []\n      this.init(arguments)\n    },\n\n    start: function() {\n      if (this.started) {\n        return\n      }\n      Backbone.history.start()\n      this.started = true\n    },\n\n    listenTo: function(router) {\n      router.on('route:start', this.push, this)\n    },\n\n    push: function(fragment, args) {\n      this.list.push(fragment)\n    },\n\n    pop: function() {\n      return this.list.pop()\n    },\n\n    init: function() {}\n  })\n\n  Helm.Notifications = {\n    publisher: _.extend({}, Backbone.Events),\n\n    publish: function(event, args) {\n      this.publisher.trigger(event, args)\n    },\n\n    subscribe: function(event, callback, context) {\n      this.publisher.on(event, callback, context)\n    },\n\n    unsubscribe: function(event, callback, context) {\n      this.publisher.off(event, callback, context)\n    }\n  }\n\n  Helm.Router = Backbone.Router.extend(Helm.Mixins.Subviews).extend({\n    initialize: function(app, $el) {\n      this.app = app\n      this.$el = $el\n\n      this.history = this.app.history\n      this.history.listenTo(this)\n\n      this.init(arguments)\n    },\n\n    // We are overriding this method to add some events before and after\n    // a route happens. Unfortunately, the anonymous function in the middle\n    // doesn't allow us to call the prototype and change just that behavior.\n    route: function(route, name, callback) {\n      if (!_.isRegExp(route)) route = this._routeToRegExp(route)\n      if (_.isfunction(name)) {\n        callback = name\n        name = ''\n      }\n      if (!callback) callback = this[name]\n\n      var router = this\n      Backbone.history.route(route, function(fragment) {\n        var args = router._extractParameters(route, fragment)\n        router.trigger('route:start', fragment, args)\n        router.execute(callback, args)\n        router.trigger.apply(router, ['route:' + name].concat(args))\n        router.trigger('route', name, args)\n        Backbone.history.trigger('route', router, name, args)\n      })\n\n      return this\n    },\n\n    go: function(fragment) {\n      this.navigate(fragment, {\n        trigger: true\n      })\n    },\n\n    back: function() {\n      this.history.pop()\n      var fragment = this.history.pop()\n      this.go(fragment)\n    },\n\n    render: function(subviews) {\n      this.renderEach(subviews)\n      this.afterRender()\n    },\n\n    page: function(subviews) {\n      this.remove()\n      this.$el.empty()\n      this.render(subviews)\n    },\n\n    defaultParent: function() {\n      return this.$el\n    },\n\n    init: function() {}\n  })\n\n\n  root.Helm = Helm\n  return Helm\n}))\n"],"sourceRoot":"/source/"}